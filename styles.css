:root {
  --gap: 10px;
  --board-size: min(1000px, 100vw);
  --nghia-color-primary: #ffcc33;
  /* Vàng sáng */
  --nghia-color-secondary: #e69138;
  /* Cam đậm */
  --text-color: #6b2a00;
  /* Màu nâu đỏ đậm */
}

* {
  box-sizing: border-box;
}

body {
  font-family: "Rowdies", sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  position: relative;
  overflow: hidden;
  transition: filter 0.5s ease-out;
}

body::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url("assets/background_image_noel.png") no-repeat center/cover;
  filter: blur(3px);
  transform: scale(0.99);
  z-index: 0;
}

#snowflakeContainer {
  position: fixed;
  /* Quan trọng để tuyết ở trên cùng và cố định */
  left: 0px;
  top: 0px;
  width: 100%;
  height: 100%;
  pointer-events: none;
  /* Rất quan trọng: cho phép click xuyên qua tuyết */
  z-index: 9999;
  /* Đảm bảo tuyết ở trên cùng */
}

.snowflake {
  /* Đặt style cơ bản cho mỗi bông tuyết */
  position: fixed;
  /* Giúp tuyết di chuyển theo viewport */
  color: #f5efef;
  user-select: none;
  line-height: 1;
  /* Để kích thước font quyết định kích thước */
  transform: translate3d(0, 0, 0);
  /* Khởi tạo biến đổi */
  will-change: transform;
  /* Báo cho trình duyệt tối ưu việc biến đổi */
}

.game-title {
  width: 100%;
  margin: 0 0 100px 0;
  padding: 12px 0;
  font-family: "Rowdies", sans-serif;
  font-size: 3.3rem;
  font-weight: 900;
  text-align: center;
  color: #f3f0e6;
  background: linear-gradient(90deg, #7f936d, #3d6042);
  border-radius: 12px;
  /* box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); */
  text-shadow: 0 3px 6px rgba(0, 0, 0, 0.25);
  letter-spacing: 2px;
  position: relative;
  z-index: 2;
}

.sigmar-one-regular {
  font-family: "Rowdies", sans-serif;
  font-weight: 400;
  font-style: normal;
}

.roboto {
  font-family: "Rowdies", cursive;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  font-variation-settings: "wdth" 100;
}

.game-container {
  position: relative;
  z-index: 1;
  /* đảm bảo game hiện rõ phía trên */
}

.board-wrapper {
  position: relative;
  width: var(--board-size);
}

.board-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.board-bg img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background-color: black;
}

/* 2. LỚP BLUR PHẢI CHỨA HÌNH NỀN VÀ CÓ Z-INDEX THẤP */
#backgroundBlurLayer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1; /* Đẩy xuống dưới cùng */

  /* ÁP DỤNG HÌNH NỀN TẠI ĐÂY */
  background-image: url("assets/result_image.jpg"); /* Đảm bảo đường dẫn đúng */
  background-size: cover;
  background-attachment: fixed;

  /* Thêm độ mờ ban đầu trực tiếp (hoặc dùng JS như dưới đây) */
  filter: blur(10px);
  transition: filter 0.5s ease-out;
}

.game-board-border-radius {
  border-radius: 12px;
  position: relative;
  background-color: blue;
  z-index: 11;
}

.game-board {
  position: relative;
  z-index: 1;
}

.wrap {
  width: var(--board-size);
  max-width: 1111px;
}

.game-board {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(3, 1fr);
  width: 100%;
}

/* mỗi card có perspective riêng để thấy depth */
.card {
  perspective: 1000px;
  cursor: pointer;
  user-select: none;
  position: relative;
  /* Thay đổi để tạo viền ngoài GÓC VUÔNG */
  border: none; /* Bỏ border cũ */
  padding: 1px; /* Tạo độ dày 2px cho viền */
  background-color: #7f936d; /* Màu của viền ngoài */
}

.card.matched {
  background-color: transparent;
}

.card:hover {
  transform: scale(1.05) rotateY(5deg);
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
  z-index: 10;
  background-color: #3d6042;
  /* nổi lên chút khi hover */
}

/* giữ tỉ lệ vuông cho mỗi card */
.card-inner {
  width: 100%;
  aspect-ratio: 1 / 1;
  position: relative;
  transition: transform 600ms cubic-bezier(0.22, 0.9, 0.15, 1);
  transform-style: preserve-3d;
  will-change: transform;
  border-radius: 8px;
  overflow: visible;
  box-shadow: 0 6px 14px rgba(16, 24, 40, 0.06);
}

/* khi có class flipped → xoay 180 độ */
.card.flipped .card-inner {
  transform: rotateY(180deg);
}

.card-inner::after {
  content: "";
  position: absolute;
  inset: 0;
  background: #000;
  opacity: 0;
  pointer-events: none;
  backface-visibility: hidden;
  transition: opacity 0.2s linear;
  z-index: 1;
}

/* khi card đang xoay (giữa 0 và 180) → bật mask */
.card-inner.is-flipping::after {
  opacity: 0.4;
  background: #000;
}

/* 2 mặt */
.card-front,
.card-back {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 14px;
}

.card-front {
  /* background: linear-gradient(180deg, #ffd54a 0%, #ffcc33 100%); */
  background-color: #7f936d;
  color: #6b2a00;
  transform: none;
  backface-visibility: hidden;
}

.card-back {
  background: #fff;
  transform: rotateY(180deg);
  backface-visibility: hidden;
}

/* Các lớp khác cần điều chỉnh để nằm trong card-inner bo góc */
.card-cover {
  /* Đảm bảo cover nằm trên cùng và cũng bo góc theo inner */
  position: absolute;
  top: 5px; /* Phải khớp với padding của .card */
  left: 5px; /* Phải khớp với padding của .card */
  width: calc(100% - 10px); /* Tương đương 100% của inner */
  height: calc(100% - 10px); /* Tương đương 100% của inner */
  background-color: transparent; /* Màu cover */
  box-shadow: 0 6px 14px rgba(16, 24, 40, 0.06);
  border-radius: 8px; /* <--- COVER CŨNG PHẢI BO GÓC */
  z-index: 10;
}

.card-icon {
  width: 222px; /* Kích thước hiển thị của icon */
  height: 222px;
  margin-bottom: 5px;
  border-radius: 12px;
  /* Đặt ảnh sprite sheet làm nền */
  background-image: url("assets/img_icons.jpg");
  background-repeat: no-repeat;
  background-position: center;
}

.shape {
  width: 80%;
  height: 80%;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-family: "Rowdies", cursive;
  pointer-events: none;
  clip-path: polygon(
    0% 15%,
    22% 22%,
    15% 0%,
    85% 0%,
    78% 22%,
    100% 15%,
    100% 85%,
    78% 78%,
    85% 100%,
    15% 100%,
    22% 78%,
    0% 85%
  );
  background: #ee0505ea;
  color: #b10000;
  font-weight: 900;
  font-size: 20px;
  padding: 8px;
  line-height: 1.2;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12) inset;
}

.card-number {
  position: absolute;
  bottom: 6px;
  right: 6px;
  font-family: "Rowdies", cursive;
  background: rgba(0, 0, 0, 0.55);
  color: white;
  padding: 4px 6px;
  border-radius: 6px;
  font-size: 36px;
  z-index: 3;
  pointer-events: none;
}

/* mặt sau chứa ảnh - xoay 180deg sẵn */
.card-back {
  transform: rotateY(180deg);
  background: #eee;
}

.card-back img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* matched (đã tìm đúng) → fade out */
.card.matched .card-inner {
  transition: transform 350ms, opacity 350ms;
  opacity: 0;
  transform: scale(0.92);
  pointer-events: none;
}

/* --- LỚP PHỦ NỀN MỜ VÀ ẨN BAN ĐẦU --- */
.popup {
  /* Cố định vị trí trên cùng mọi thứ */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Tạo nền mờ (Màu đen 70% trong suốt) */
  background-color: rgba(0, 0, 0, 0.7);

  /* Căn giữa nội dung */
  display: flex;
  justify-content: center;
  align-items: center;

  /* Đảm bảo nó nằm trên mọi thứ (trừ các lớp phủ khác) */
  z-index: 1000;

  /* Mặc định ẩn */
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

/* --- TRẠNG THÁI HIỂN THỊ (Khi có class .show) --- */
.popup.show,
.popup.show-modal {
  opacity: 1;
  visibility: visible;
}

.popup-box {
  background: white;
  margin-top: 50px;
  padding: 18px;
  border-radius: 10px;
  text-align: center;
  max-width: 60%;
  width: 100%;
  box-shadow: 0 10px 30px rgba(2, 6, 23, 0.2);
}

.popup-box img {
  max-width: 60%;
  max-height: 93vh;
  height: auto;
  width: auto;
  object-fit: contain;
  border-radius: 8px;
  display: block;
  margin: 0 auto;
}

.popup-actions {
  margin-top: 12px;
  display: flex;
  gap: 12px;
  justify-content: center;
}

.btn {
  padding: 8px 14px;
  border-radius: 8px;
  border: 0;
  cursor: pointer;
  font-weight: 700;
}

.btn-true {
  background: #16a34a;
  color: white;
}

.btn-false {
  background: #dc2626;
  color: white;
}

/* tấm che riêng từng card */
/* .card-cover {
  position: absolute;
  inset: 0;
  background: #fff;
  z-index: 0;
  transition: opacity 0.3s ease;
} */

/* khi card được matched */
.card.matched .card-inner,
.card.matched .card-cover {
  opacity: 0;
  transform: scale(0.9);
  transition: opacity 0.5s ease, transform 0.5s ease;
  pointer-events: none;
}

/* Thêm style cho Quiz Popup */
.quiz-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-top: 15px;
}

.btn-answer {
  font-size: 24px;
  background: transparent;
  color: var(--text-color);
  border: 3px solid var(--nghia-color-secondary);
  padding: 18px 18px 18px 70px;
  border-radius: 999px;
  font-weight: 200;
  font-family: "Rowdies", sans-serif;
  transition: all 0.2s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  position: relative;
  text-align: left;
}

.btn-answer::before {
  content: attr(data-answer);
  /* Lấy ký tự (A, B, C, D) từ data-answer */
  position: absolute;
  left: 10px;
  /* Đẩy ra sát mép trái (tính cả padding) */
  top: 50%;
  transform: translateY(-50%);

  /* Style cho hình tròn */
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--nghia-color-secondary);
  /* Màu nền hình tròn */
  color: #000;
  /* Màu chữ ký tự */
  font-weight: 200;
  font-size: 24px;

  /* Căn giữa chữ A/B/C/D trong hình tròn */
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-answer:hover {
  background: var(--nghia-color-primary);
  /* Đổi màu nền khi hover */
  color: #000;
  border-color: var(--nghia-color-primary);
}

.question-text {
  font-size: 36px;
  font-weight: 700;
  margin-bottom: 77px;
  font-family: "Rowdies", cursive;
}

.answer-result {
  margin-top: 15px;
  font-size: 18px;
  font-weight: bold;
}

.popup-wrong .wrong-icon {
  font-size: 40px;
  margin-bottom: 10px;
}

.wrong-text {
  font-family: "Rowdies", cursive;
  font-weight: 500;
  font-size: 18px;
  color: #dc2626;
}

/* CSS Pháo hoa */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  display: none;
  /* Mặc định ẩn */
  justify-content: center;
  align-items: center;
  z-index: 10000;
  transition: opacity 0.3s ease;
  opacity: 0;
}

.modal-overlay.show-modal {
  display: flex;
  opacity: 1;
}

#resultModal .modal-content {
  position: relative;
  /* RẤT QUAN TRỌNG */
  overflow: hidden;
  /* Ngăn pháo hoa bắn ra khỏi modal (tùy chọn) */
}

#resultModal.show-modal {
  display: flex;
  /* hoặc block, tùy thuộc vào cách bạn căn giữa */
  z-index: 9999;
}

.modal-content {
  background-color: white;
  padding: 30px;
  border-radius: 12px;
  text-align: center;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  position: relative;
  transform: scale(0.8);
  transition: transform 0.3s ease;
}

.modal-overlay.show-modal .modal-content {
  transform: scale(1);
}

#modalTitle {
  font-size: 2.5rem;
  margin-top: 0;
  font-weight: bold;
}

#modalMessage {
  font-size: 1.2rem;
  margin-bottom: 20px;
}

.close-btn {
  background-color: #007bff;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 1rem;
  transition: background-color 0.2s;
}

.close-btn:hover {
  background-color: #0056b3;
}

/* --- CSS Cho Canvas Pháo Hoa (quan trọng: absolute) --- */
#fireworksCanvas {
  /* Đặt Canvas lên trên Modal */
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1000;
  /* Đảm bảo nó nằm trên mọi thứ */
  pointer-events: none;
  /* Không chặn click vào nút */
  display: none;
  /* Khởi tạo ẩn */
}

/* --- HỘP CHỨA NỘI DUNG (Ví dụ: Quiz) --- */
.popup-content {
  text-align: center;
  /* TẠO NỀN TRẮNG RÕ RÀNG */
  background-color: #ffffff;
  font-size: 30px;
  color: #333; /* Màu chữ dễ đọc */
  padding: 30px;
  border-radius: 12px;
  width: 90%; /* Chiếm 90% chiều rộng */
  max-width: 1600px; /* Nhưng không quá 500px */

  /* Hiệu ứng đổ bóng */
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);

  /* Hiệu ứng vào/ra (optional) */
  transform: scale(0.95);
  transition: transform 0.3s ease;
}

.popup.show .popup-content,
.popup.show-modal .modal-content {
  transform: scale(1); /* Phóng to khi hiển thị */
}

/* --- CONTAINER CHO CÁC NÚT TRẮC NGHIỆM --- */
#multipleChoiceContainer {
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2 cột */
  gap: 10px;
  margin-top: 20px;
}

/* --- NÚT TIẾT LỘ ĐÁP ÁN (Dùng cho Tự luận) --- */
#essayRevealButton {
  /* Đảm bảo nó nằm giữa và dễ click */
  width: 100%;
  margin-top: 20px;
  background-color: #fcd34d; /* Màu vàng */
  border-color: #b45309;
  color: #78350f;
  text-align: center;
}

#essayRevealButton:hover {
  background-color: #fde68a;
}

/* --- TEXT HIỂN THỊ ĐÁP ÁN TỰ LUẬN --- */
#essayAnswerText {
  font-size: 33px;
  font-weight: 200;
  padding: 10px;
  border: 1px dashed #16a34a;
  background-color: #ecfdf5;
  border-radius: 4px;
  margin-top: 20px;
  text-align: left;
}

.btn-continue {
  text-align: center;
  width: fit-content;
  padding: 12px 44px;
  border: none;
  background-color: #10b981; /* Màu xanh lá */
  font-family: "Rowdies", sans-serif;
  color: white;
  font-size: 20px;
  font-weight: 200;
  border-radius: 12px;
  cursor: pointer;
  transition: background-color 0.2s;
}
.btn-continue:hover {
  background-color: #059669;
}

/* --- HIỆU ỨNG FLASH SCREEN TOÀN MÀN HÌNH --- */
#flashScreen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Ban đầu ẩn */
  opacity: 0;
  visibility: hidden;
  z-index: 9999; /* Luôn nằm trên cùng (dưới các popup) */
  pointer-events: none; /* Rất quan trọng: không chặn tương tác */
}

/* Các lớp màu sắc */
.flash-correct {
  background-color: rgba(22, 163, 74, 0.4); /* Xanh lá mờ */
}

.flash-wrong {
  background-color: rgba(220, 38, 38, 0.4); /* Đỏ mờ */
}

/* Keyframes cho hiệu ứng nháy */
@keyframes flash {
  0% {
    opacity: 1;
    visibility: visible;
  }
  100% {
    opacity: 0;
    visibility: hidden;
  }
}

/* Áp dụng animation */
.is-flashing {
  animation: flash 0.5s ease-out forwards; /* Nháy trong 0.5 giây */
}
